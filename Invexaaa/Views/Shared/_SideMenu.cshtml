@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@inject IConfiguration Configuration


@{
    var currentController = ViewContext.RouteData.Values["controller"]?.ToString();
    var currentAction = ViewContext.RouteData.Values["action"]?.ToString();
    var systemUrl = Configuration["PublicBaseUrl"];
}

<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />

<style>
    /* =====================================================
       INVEXA SIDE MENU
    ===================================================== */

    .invexa-side {
        width: 72px;
        background: #fff;
        border-right: 1px solid #e5e7eb;
        padding: 12px 8px;
        display: flex;
        flex-direction: column;
        transition: width .25s ease;
    }

        /* Hover / lock expand */
        .invexa-side:hover,
        .invexa-side.expanded {
            width: 260px;
        }

    /* Toggle button */


    


    /* Menu links */
    .invexa-side-link {
        height: 48px;
        width: 100%;
        margin-bottom: 6px;
        border-radius: 14px;
        text-decoration: none;
        color: #000;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        transition: background .15s ease;
        position: relative;
    }

        .invexa-side-link i {
            font-size: 20px;
        }

        .invexa-side-link:hover,
        .invexa-side-link.active {
            background: #f2f2f2;
        }

    /* Text */
    .invexa-side-text {
        font-size: 14px;
    }

    /* Expanded state */
    .invexa-side:hover .invexa-side-link,
    .invexa-side.expanded .invexa-side-link {
        justify-content: flex-start;
        padding: 0 14px;
    }

    .invexa-side:hover .invexa-side-text,
    .invexa-side.expanded .invexa-side-text {
        display: inline;
    }

    /* Hide text when collapsed */
    /* Hide menu text & sections when collapsed */
    .invexa-side:not(:hover):not(.expanded) .invexa-side-text,
    .invexa-side:not(:hover):not(.expanded) .invexa-side-section {
        display: none;
    }


    /* Section label */
    .invexa-side-section {
        margin: 14px 0 6px;
        padding-left: 14px;
        font-size: 11px;
        color: #6b7280;
        text-transform: uppercase;
    }


    /* =====================================================
       STOCK SUBMENU — FINAL, LOCKED
    ===================================================== */

    .invexa-submenu {
        display: none;
        flex-direction: column;
        margin: 6px 0 12px 0; /* ✅ consistent vertical rhythm */
        padding-left: 18px; /* ✅ less indentation */
        border-left: 2px solid #e5e7eb;
    }

    .invexa-side:hover .invexa-submenu,
    .invexa-side.expanded .invexa-submenu {
        display: flex;
    }

    .invexa-submenu .invexa-side-link {
        height: 40px; /* ✅ closer to parent */
        margin-bottom: 4px; /* ✅ breathing room */
        background: transparent;
        border-radius: 10px; /* ✅ softer, matches system */
        padding: 0 14px 0 36px; /* ✅ aligned text + icon */
        justify-content: flex-start;
        position: relative;
    }


        /* disable main pill hover */
        .invexa-submenu .invexa-side-link:hover {
            background: transparent;
        }

        .invexa-submenu .invexa-side-link i {
            font-size: 16px;
            opacity: 0.8;
        }

        /* inset hover highlight */
        .invexa-submenu .invexa-side-link::after {
            content: "";
            position: absolute;
            left: 0;
            right: 0;
            top: 4px;
            bottom: 4px;
            background: transparent;
            border-radius: 8px;
            pointer-events: none;
            z-index: 0;
        }

        .invexa-submenu .invexa-side-link:hover::after {
            background: #f7f7f7;
        }

        /* ensure text + icon above highlight */
        .invexa-submenu .invexa-side-link > * {
            position: relative;
            z-index: 1;
        }

        /* active indicator */
        .invexa-submenu .invexa-side-link.active::before {
            content: "";
            position: absolute;
            left: 10px;
            top: 6px;
            bottom: 6px;
            width: 3px;
            background: #9ca3af;
            border-radius: 2px;
        }
    /* Submenu section label tighter */
    .invexa-submenu .invexa-side-section {
        margin: 10px 0 6px;
        padding-left: 26px;
        font-size: 10px;
        letter-spacing: .08em;
        color: #9ca3af;
    }

    /* Submenu icon lighter */
    .invexa-submenu .invexa-side-link i {
        font-size: 15px;
        opacity: .75;
    }

    /* Active submenu stronger */
    .invexa-submenu .invexa-side-link.active::before {
        background: #111827;
    }

    .invexa-submenu .invexa-side-link i {
        font-size: 16px;
        margin-right: 10px;
        opacity: .75;
    }

    .invexa-submenu .invexa-side-text {
        font-size: 13.5px;
    }



    /* Push QR to bottom */
    .invexa-side-spacer {
        flex-grow: 1;
    }

    /* QR container */
    .invexa-side-qr {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
        padding: 12px 0 6px;
        border-top: 1px dashed #e5e7eb;
    }

    /* QR image */
    .invexa-qr-img {
        width: 72px;
        height: 72px;
        padding: 6px;
        background: #fff;
        border: 1px solid #e5e7eb;
        border-radius: 10px;
    }

    /* QR text */
    .invexa-qr-text {
        font-size: 11px;
        color: #6b7280;
    }
    /* Hide QR when side menu is collapsed */
    .invexa-side:not(:hover):not(.expanded) .invexa-side-qr {
        display: none;
    }

</style>

<aside class="invexa-side" id="invexaSideMenu">

    <!-- TOGGLE -->


    <!-- LOGO -->

    <!-- MAIN -->
    <a asp-controller="Dashboard" asp-action="Index"
       class="invexa-side-link @(currentController == "Dashboard" ? "active" : "")">
        <i class="bi bi-speedometer2"></i>
        <span class="invexa-side-text">Dashboard</span>
    </a>

    <a asp-controller="Item" asp-action="ItemIndex"
       class="invexa-side-link @(currentController == "Item" ? "active" : "")">
        <i class="bi bi-pencil-square"></i>
        <span class="invexa-side-text">Manage Items</span>
    </a>

    <a asp-controller="Category" asp-action="CategoryIndex"
       class="invexa-side-link @(currentController == "Category" ? "active" : "")">
        <i class="bi bi-tags"></i>
        <span class="invexa-side-text">Maintain Category</span>
    </a>

    <a asp-controller="Supplier" asp-action="SupplierIndex"
       class="invexa-side-link @(currentController == "Supplier" ? "active" : "")">
        <i class="bi bi-truck"></i>
        <span class="invexa-side-text">Maintain Supplier</span>
    </a>

    <!-- ===== MAINTAIN STOCK (PARENT) ===== -->
    <a asp-controller="Stock" asp-action="StockIndex"
       class="invexa-side-link stock-parent @(currentController == "Stock" ? "active" : "")">
        <i class="bi bi-boxes"></i>
        <span class="invexa-side-text">Maintain Stock</span>
    </a>

    <!-- ===== STOCK SUBMENU ===== -->
    <div class="invexa-submenu">



        <a asp-controller="Stock"
           asp-action="StockTransactionHistory"
           class="invexa-side-link @(currentAction == "StockTransactionHistory" ? "active" : "")">
            <i class="bi bi-arrow-left-right"></i>
            <span class="invexa-side-text">Transaction History</span>
        </a>


        <a asp-controller="Stock"
           asp-action="StockAdjustmentHistory"
           class="invexa-side-link @(currentAction == "StockAdjustmentHistory" ? "active" : "")">
            <i class="bi bi-sliders"></i>
            <span class="invexa-side-text">Adjustment History</span>
        </a>


    </div>


    <a asp-controller="ExpiryTracking" asp-action="ExpiryTrackingIndex"
       class="invexa-side-link @(currentController == "ExpiryTracking" ? "active" : "")">
        <i class="bi bi-hourglass-split"></i>
        <span class="invexa-side-text">Expiry Tracking</span>
    </a>

    <a asp-controller="Inventory" asp-action="InventoryIndex"
       class="invexa-side-link @(currentController == "Inventory" ? "active" : "")">
        <i class="bi bi-archive"></i>
        <span class="invexa-side-text">Inventory</span>
    </a>

    <a asp-controller="Alerts" asp-action="Index"
       class="invexa-side-link @(currentController == "Alerts" ? "active" : "")">
        <i class="bi bi-exclamation-triangle"></i>
        <span class="invexa-side-text">Alerts & Notifications</span>
    </a>

    <a asp-controller="Reports" asp-action="Overview"
       class="invexa-side-link @(currentController == "Reports" ? "active" : "")">
        <i class="bi bi-file-earmark-text"></i>
        <span class="invexa-side-text">Reports & Analytics</span>
    </a>

    <div class="invexa-side-section">System</div>

    <a asp-controller="User"
       asp-action="UpdateProfile"
       class="invexa-side-link @(currentController == "User" ? "active" : "")">
        <i class="bi bi-person-gear"></i>
        <span class="invexa-side-text">Update Profile</span>
    </a>


    <a asp-controller="Help" asp-action="HelpIndex" class="invexa-side-link">
        <i class="bi bi-question-circle"></i>
        <span class="invexa-side-text">Help</span>
    </a>

    <a asp-controller="Feedback" asp-action="CreateFeedback" class="invexa-side-link">
        <i class="bi bi-chat-dots"></i>
        <span class="invexa-side-text">Feedback</span>
    </a>


    <a asp-controller="User" asp-action="Logout" class="invexa-side-link">
        <i class="bi bi-box-arrow-right"></i>
        <span class="invexa-side-text">Logout</span>
    </a>

    <!-- PUSH MENU CONTENT UP -->
    <div class="invexa-side-spacer"></div>
    <!-- =========================
         MOBILE ACCESS QR
    ========================= -->
    <div class="invexa-side-qr">
        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=@systemUrl"
             alt="Scan to open Invexa system"
             class="invexa-qr-img" />


        <span class="invexa-side-text invexa-qr-text">
            Scan on phone
        </span>
    </div>
</aside>


